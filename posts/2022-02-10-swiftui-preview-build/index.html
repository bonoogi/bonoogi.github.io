<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SwiftUI Preview 빌드가 너무 오래걸려서 써먹을수가 없을때 | Hell yeah, World</title><meta name=keywords content="swiftui,preview"><meta name=description content="야 이게 무슨 408 Request Timeout이냐?"><meta name=author content="구구리"><link rel=canonical href=https://bonoogi.github.io/posts/2022-02-10-swiftui-preview-build/><link crossorigin=anonymous href=/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bonoogi.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bonoogi.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bonoogi.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://bonoogi.github.io/apple-touch-icon.png><link rel=mask-icon href=https://bonoogi.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-DKVGJN68MW"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DKVGJN68MW",{anonymize_ip:!1})}</script><meta property="og:title" content="SwiftUI Preview 빌드가 너무 오래걸려서 써먹을수가 없을때"><meta property="og:description" content="야 이게 무슨 408 Request Timeout이냐?"><meta property="og:type" content="article"><meta property="og:url" content="https://bonoogi.github.io/posts/2022-02-10-swiftui-preview-build/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-10T23:45:20+09:00"><meta property="article:modified_time" content="2022-02-10T23:45:20+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="SwiftUI Preview 빌드가 너무 오래걸려서 써먹을수가 없을때"><meta name=twitter:description content="야 이게 무슨 408 Request Timeout이냐?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bonoogi.github.io/posts/"},{"@type":"ListItem","position":2,"name":"SwiftUI Preview 빌드가 너무 오래걸려서 써먹을수가 없을때","item":"https://bonoogi.github.io/posts/2022-02-10-swiftui-preview-build/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SwiftUI Preview 빌드가 너무 오래걸려서 써먹을수가 없을때","name":"SwiftUI Preview 빌드가 너무 오래걸려서 써먹을수가 없을때","description":"야 이게 무슨 408 Request Timeout이냐?","keywords":["swiftui","preview"],"articleBody":"프로젝트별로 상황이야 다르겠지만, SwiftUI 프리뷰를 사용할 때 빌드하는 시간이 너무 오래 걸리면 “야 이거 너무 오래 걸려서 프리뷰 기능을 잠깐 멈췄어. 준비되면 Resume 버튼을 누르렴” 식의 안내 메시지가 나온다. 그래서 Resume을 누르면? 또 한참을 빌드하다가 저 메시지를 또 보여준다. 그래서 Resume을 또 누르면? 또 한참을 빌드하다가…\n라는 어떤 재귀적인 기분이 드는 상황을 맞닥뜨리는 경우가 있다. 아니 그런데 솔직히, 프리뷰하나 띄우는 빌드가 그렇게 오래걸릴수가 있나? 프리뷰 빌드가 무슨 클린 빌드도 아니고, 뭔가 프로젝트가 동쪽으로 서쪽으로 유유히 표류하는 것도 아닐텐데 말이다.\n바로 그 상황에서 여러분이 체크해야하는 것이 있다. 바로 앱 프로젝트의 Build Phases 설정이다. Xcode 프로젝트에서 프로젝트에 각종 분석 도구를 붙이거나, 뭔가 정적으로 코드를 생성하는 작업 등을 자동으로 수행하도록 할 때 1차적으로 찾는 것이 바로 이 Build Phases다. 번역하면 빌드 단계, 그러니까 빌드를 수행하면 여기 정의한 순서대로 스크립트가 됐든 뭐가 됐든 이 작업도 같이 하라는 식으로 이것저것 붙일 수 있는 것이다.\n내 경우에는 이 Build Phases에 Firebase Crashlytics에 dSYM을 업로드하는 스크립트와 SwiftLint, SwiftGen, Apollo CodeGen 작업을 수행하는 스크립트등을 추가해놨었다. 근데 빌드를 돌리고 나중에 보고서를 체크해보니 Apollo CodeGen과 dSYM 업로드가 생각보다 너무 많은 시간을 잡아먹는게 아닌가? 사실상 매번 빌드할때마다 수행할 필요도 없는데… 내가 터미널에 명령어 한번 입력하는 횟수 줄이겠다고 한 짓이 SwiftUI 프리뷰조차 쓰지 못하게 한 것이다. 하지만 걱정 마라. 다 방법이 있다. 바로 작업 수행 시간이 오래 걸릴만한 Build Phase 스크립트의 상단에 아래와 같은 코드를 추가하는 것이다.\nif [ $ENABLE_PREVIEWS = YES ] then  echo \"SwiftUI Preview 빌드중에는 이 빌드 단계를 무시합니다.\"  exit 0 fi  # 필요하지만 어쨌든 오래 걸리는 작업... ENABLE_PREVIEWS는 Xcode에서 SwiftUI 프리뷰를 위한 빌드일때 갖고있는 내부 변수같은거라고 생각하면 된다. 만약 시간이 오래 걸리는데 굳이 모든 빌드중에 필요하지 않은 빌드 단계가 있다면, 위와 같은 조건 분기를 만들고 exit 0 명령어를 통해 해당 단계를 정상종료 시켜버리면 되는 것이다. 자, 이제 시뮬레이터도, 디버깅을 위한 실기기와 USB 케이블도 치워버리고 SwiftUI 프리뷰와 함께 바로바로 UI 구현 사항을 체크하도록 하자.\n","wordCount":"295","inLanguage":"en","datePublished":"2022-02-10T23:45:20+09:00","dateModified":"2022-02-10T23:45:20+09:00","author":{"@type":"Person","name":"구구리"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bonoogi.github.io/posts/2022-02-10-swiftui-preview-build/"},"publisher":{"@type":"Organization","name":"Hell yeah, World","logo":{"@type":"ImageObject","url":"https://bonoogi.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bonoogi.github.io/ accesskey=h title="Hell yeah, World (Alt + H)">Hell yeah, World</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>SwiftUI Preview 빌드가 너무 오래걸려서 써먹을수가 없을때</h1><div class=post-description>야 이게 무슨 408 Request Timeout이냐?</div><div class=post-meta><span title="2022-02-10 23:45:20 +0900 +0900">February 10, 2022</span>&nbsp;·&nbsp;구구리</div></header><div class=post-content><p>프로젝트별로 상황이야 다르겠지만, SwiftUI 프리뷰를 사용할 때 빌드하는 시간이 너무 오래 걸리면 <strong>&ldquo;야 이거 너무 오래 걸려서 프리뷰 기능을 잠깐 멈췄어. 준비되면 Resume 버튼을 누르렴&rdquo;</strong> 식의 안내 메시지가 나온다. 그래서 Resume을 누르면? 또 한참을 빌드하다가 저 메시지를 또 보여준다. 그래서 Resume을 또 누르면? 또 한참을 빌드하다가&mldr;</p><p>라는 어떤 재귀적인 기분이 드는 상황을 맞닥뜨리는 경우가 있다. 아니 그런데 솔직히, 프리뷰하나 띄우는 빌드가 그렇게 오래걸릴수가 있나? 프리뷰 빌드가 무슨 클린 빌드도 아니고, 뭔가 프로젝트가 동쪽으로 서쪽으로 유유히 표류하는 것도 아닐텐데 말이다.</p><p>바로 그 상황에서 여러분이 체크해야하는 것이 있다. 바로 앱 프로젝트의 Build Phases 설정이다. Xcode 프로젝트에서 프로젝트에 각종 분석 도구를 붙이거나, 뭔가 정적으로 코드를 생성하는 작업 등을 자동으로 수행하도록 할 때 1차적으로 찾는 것이 바로 이 Build Phases다. 번역하면 빌드 단계, 그러니까 빌드를 수행하면 여기 정의한 순서대로 스크립트가 됐든 뭐가 됐든 이 작업도 같이 하라는 식으로 이것저것 붙일 수 있는 것이다.</p><p>내 경우에는 이 Build Phases에 Firebase Crashlytics에 dSYM을 업로드하는 스크립트와 SwiftLint, SwiftGen, Apollo CodeGen 작업을 수행하는 스크립트등을 추가해놨었다. 근데 빌드를 돌리고 나중에 보고서를 체크해보니 Apollo CodeGen과 dSYM 업로드가 생각보다 너무 많은 시간을 잡아먹는게 아닌가? 사실상 매번 빌드할때마다 수행할 필요도 없는데&mldr; 내가 터미널에 명령어 한번 입력하는 횟수 줄이겠다고 한 짓이 SwiftUI 프리뷰조차 쓰지 못하게 한 것이다. 하지만 걱정 마라. 다 방법이 있다. 바로 작업 수행 시간이 오래 걸릴만한 Build Phase 스크립트의 상단에 아래와 같은 코드를 추가하는 것이다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $ENABLE_PREVIEWS <span style=color:#f92672>=</span> YES <span style=color:#f92672>]</span> <span style=color:#66d9ef>then</span> 
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;SwiftUI Preview 빌드중에는 이 빌드 단계를 무시합니다.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 필요하지만 어쨌든 오래 걸리는 작업...</span>
</span></span></code></pre></div><p>ENABLE_PREVIEWS는 Xcode에서 SwiftUI 프리뷰를 위한 빌드일때 갖고있는 내부 변수같은거라고 생각하면 된다. 만약 시간이 오래 걸리는데 굳이 모든 빌드중에 필요하지 않은 빌드 단계가 있다면, 위와 같은 조건 분기를 만들고 exit 0 명령어를 통해 해당 단계를 정상종료 시켜버리면 되는 것이다. 자, 이제 시뮬레이터도, 디버깅을 위한 실기기와 USB 케이블도 치워버리고 SwiftUI 프리뷰와 함께 바로바로 UI 구현 사항을 체크하도록 하자.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bonoogi.github.io/tags/swiftui/>swiftui</a></li><li><a href=https://bonoogi.github.io/tags/preview/>preview</a></li></ul></footer><script src=https://utteranc.es/client.js repo=bonoogi/blog-comment issue-term=pathname label=comment theme=github-dark crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2022 <a href=https://bonoogi.github.io/>Hell yeah, World</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>