<!doctype html><html lang="" class="no-js"><head><title>[Swift] Codable로 JSON 좀 더 유연하게 써먹기 – Hell yeah, World!</title><meta name="description" content=""><meta name="robots" content="index,follow"><meta name="generator" content="Eleventy"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="twitter:site" content="@bonoogiclient"><meta name="twitter:creator" content="@bonoogiclient"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://bonoogi.ghost.io/swift-codablero-json-irijeori-sseomeoggi/"><meta name="twitter:title" content="[Swift] Codable로 JSON 좀 더 유연하게 써먹기 – Hell yeah, World!"><meta name="twitter:description" content="Swift는 Codable [https://developer.apple.com/documentation/swift/codable] 덕분에
JSON 다루기가 퍽 편한 편이다. 하지만 JSON과 모델이 1:1로 대응하는게 아닌 약간 변칙적인 형태의 JSON을 다루게 되는 경우에는
Codable보다는 SwiftyJSON [https://github.com/SwiftyJSON/SwiftyJSON]과 같은 라이브러리가 좀 더
편하다보니 &#39;아 그냥 Codable 치우고 SwiftyJSON 쓸까?&#39; 싶을때가 종종 있다. 특히 JSON Object가 중첩된 상태이거나,
평평하게 펴진 JSON Object를 중첩된 형태의 모델로 만들거나 해야할 때는 직접 JSON에 대한 Key에 접근해서 값을 대입해주는게 문제
상황에 대처하기 쉽기 때문에 직관적으로 구현하기에는 JSON에 Dictionary 형태로 접근할 수 있는 SwiftyJSON이 훨씬
편하다(아니면 진짜로 JSON을 Dictionary 형태로"><meta name="twitter:image" content=""><link rel="author" href="https://bonoogi.github.io"><link rel="publisher" href="https://bonoogi.ghost.io"><meta itemprop="name" content="[Swift] Codable로 JSON 좀 더 유연하게 써먹기 – Hell yeah, World!"><meta itemprop="description" content="Swift는 Codable [https://developer.apple.com/documentation/swift/codable] 덕분에
JSON 다루기가 퍽 편한 편이다. 하지만 JSON과 모델이 1:1로 대응하는게 아닌 약간 변칙적인 형태의 JSON을 다루게 되는 경우에는
Codable보다는 SwiftyJSON [https://github.com/SwiftyJSON/SwiftyJSON]과 같은 라이브러리가 좀 더
편하다보니 &#39;아 그냥 Codable 치우고 SwiftyJSON 쓸까?&#39; 싶을때가 종종 있다. 특히 JSON Object가 중첩된 상태이거나,
평평하게 펴진 JSON Object를 중첩된 형태의 모델로 만들거나 해야할 때는 직접 JSON에 대한 Key에 접근해서 값을 대입해주는게 문제
상황에 대처하기 쉽기 때문에 직관적으로 구현하기에는 JSON에 Dictionary 형태로 접근할 수 있는 SwiftyJSON이 훨씬
편하다(아니면 진짜로 JSON을 Dictionary 형태로"><meta itemprop="image" content=""><meta property="og:url" content="https://bonoogi.ghost.io/swift-codablero-json-irijeori-sseomeoggi/"><meta property="og:type" content="website"><meta property="og:title" content="[Swift] Codable로 JSON 좀 더 유연하게 써먹기 – Hell yeah, World!"><meta property="og:image" content=""><meta property="og:description" content="Swift는 Codable [https://developer.apple.com/documentation/swift/codable] 덕분에
JSON 다루기가 퍽 편한 편이다. 하지만 JSON과 모델이 1:1로 대응하는게 아닌 약간 변칙적인 형태의 JSON을 다루게 되는 경우에는
Codable보다는 SwiftyJSON [https://github.com/SwiftyJSON/SwiftyJSON]과 같은 라이브러리가 좀 더
편하다보니 &#39;아 그냥 Codable 치우고 SwiftyJSON 쓸까?&#39; 싶을때가 종종 있다. 특히 JSON Object가 중첩된 상태이거나,
평평하게 펴진 JSON Object를 중첩된 형태의 모델로 만들거나 해야할 때는 직접 JSON에 대한 Key에 접근해서 값을 대입해주는게 문제
상황에 대처하기 쉽기 때문에 직관적으로 구현하기에는 JSON에 Dictionary 형태로 접근할 수 있는 SwiftyJSON이 훨씬
편하다(아니면 진짜로 JSON을 Dictionary 형태로"><meta property="og:site_name" content="Hell yeah, World!"><meta property="og:locale" content=""><meta property="article:author" content="https://bonoogi.ghost.io"><style>:root{--color-primary:#3eb0ef;--color-base:#15171a;--color-secondary:#5b7a81;--color-border:#c7d5d8;--color-bg:#f5f5f5;--font-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;--font-serif:Georgia,Times,serif;--font-mono:Menlo,Courier,monospace;--font-light:100;--font-normal:400;--font-bold:700;--font-heavy:800;--height:4rem;--margin:2rem;--radius:0.6rem}a,abbr,acronym,address,applet,article,aside,audio,big,blockquote,body,canvas,caption,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,ul,var,video{margin:0;padding:0;border:0;font:inherit;font-size:100%;vertical-align:baseline}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}table{border-spacing:0;border-collapse:collapse}img{max-width:100%;height:auto}html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}a{background-color:transparent}a:active,a:hover{outline:0}b,strong{font-weight:700}dfn,em,i{font-style:italic}h1{margin:.67em 0;font-size:2em}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}mark{background-color:#fdffb6}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible;border:none}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input:focus{outline:0}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{box-sizing:content-box;-webkit-appearance:textfield}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}legend{padding:0;border:0}textarea{overflow:auto}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{overflow-x:hidden;overflow-y:scroll;font-size:62.5%;background:var(--color-base);-webkit-tap-highlight-color:transparent}body{overflow-x:hidden;color:#3c484e;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-size:1.5rem;line-height:1.6em;font-weight:400;font-style:normal;letter-spacing:0;text-rendering:optimizeLegibility;background:#fff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-moz-font-feature-settings:"liga" on}::selection{text-shadow:none;background:#cbeafb}hr{position:relative;display:block;width:100%;margin:1.8em 0 2.4em;padding:0;height:1px;border:0;border-top:1px solid #e3e9ed}audio,canvas,iframe,img,svg,video{vertical-align:middle}fieldset{margin:0;padding:0;border:0}textarea{resize:vertical}blockquote,dl,ol,p,ul{margin:0 0 1.5em 0}ol,ul{padding-left:1.3em;padding-right:1.5em}ol ol,ol ul,ul ol,ul ul{margin:.5em 0 1em}ul{list-style:disc}ol{list-style:decimal}ol,ul{max-width:100%}li{margin:.5em 0;padding-left:.3em;line-height:1.6em}dt{float:left;margin:0 20px 0 0;width:120px;font-weight:500;text-align:right}dd{margin:0 0 5px 0;text-align:left}blockquote{margin:.3em 0 1.8em;padding:0 1.6em 0 1.6em;border-left:#cbeafb .5em solid}blockquote p{margin:.8em 0;font-size:1.2em;font-weight:300}blockquote small{display:inline-block;margin:.8em 0 .8em 1.5em;font-size:.9em;opacity:.8}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:400}a{color:#26a8ed;text-decoration:none}a:hover{text-decoration:underline}h1,h2,h3,h4,h5,h6{margin-top:0;color:var(--color-base);line-height:1.15;font-weight:700;text-rendering:optimizeLegibility}h1{margin:0 0 .5em 0;font-size:4rem;font-weight:700}@media (max-width:500px){h1{font-size:2rem}}h2{margin:1.5em 0 .5em 0;font-size:2rem}@media (max-width:500px){h2{font-size:1.8rem}}h3{margin:1.5em 0 .5em 0;font-size:1.8rem;font-weight:500}@media (max-width:500px){h3{font-size:1.7rem}}h4{margin:1.5em 0 .5em 0;font-size:1.6rem;font-weight:500}h5{margin:1.5em 0 .5em 0;font-size:1.4rem;font-weight:500}h6{margin:1.5em 0 .5em 0;font-size:1.4rem;font-weight:500}.viewport{display:flex;flex-direction:column;justify-content:space-between;min-height:100vh}.container{max-width:1120px;margin:0 auto;padding:0 4vw}.content{margin:0 auto;font-size:2rem;line-height:1.7em}.content-body{display:flex;flex-direction:column;font-family:var(--font-serif)}.post-full-content{max-width:720px;margin:0 auto;background:#fff}.post-full-content figcaption{margin:1em 3em 0;font-size:55%;line-height:1.6em;text-align:center;font-weight:400}.post-feature-image img{margin:0 0 3vw;width:100%;height:500px;object-fit:cover}.content-body h1,.content-body h2,.content-body h3,.content-body h4,.content-body h5,.content-body h6{font-family:var(--font-sans-serif)}.content-body h1{margin:1em 0 .5em 0;font-size:3.4rem;font-weight:700}@media (max-width:500px){.content-body h1{font-size:2.8rem}}.content-title{margin:0 0 .8em;font-size:5rem}@media (max-width:500px){.content-title{margin:.8em 0;font-size:3.4rem}.content{font-size:1.8rem}}.content-body h2{margin:.8em 0 .4em 0;font-size:3.2rem;font-weight:700}@media (max-width:500px){.content-body h2{font-size:2.6rem}}.content-body h3{margin:.5em 0 .2em 0;font-size:2.8rem;font-weight:700}@media (max-width:500px){.content-body h3{font-size:2.2rem}}.content-body h4{margin:.5em 0 .2em 0;font-size:2.4rem;font-weight:700}@media (max-width:500px){.content-body h4{font-size:2.2rem}}.content-body h5{display:block;margin:.5em 0;padding:1em 0 1.5em;border:0;font-family:Georgia,serif;color:var(--color-primary);font-style:italic;font-size:3.2rem;line-height:1.35em;text-align:center}.content-body h6{margin:.5em 0 .2em 0;font-size:2rem;font-weight:700}.content-body figure{margin:.4em 0 1.6em;font-size:2.8rem;font-weight:700}.content-body pre{margin:.4em 0 1.8em;font-size:1.6rem;line-height:1.4em;white-space:pre-wrap;padding:20px;background:var(--color-base);color:#fff;border-radius:12px}.site-head{padding-top:20px;padding-bottom:20px;color:#fff;background:var(--color-base);background-position:center;background-size:cover}.site-nav-item{display:inline-block;padding:5px 10px;color:#fff;opacity:.7}.site-nav-item:hover{text-decoration:none;opacity:1}.site-nav-right .site-nav-button{margin-left:.3rem}.site-nav-icon{height:15px;margin:-5px 0 0;vertical-align:baseline}.site-logo{height:25px}.site-mast{display:flex;align-items:center;justify-content:space-between}.site-mast-right{display:flex;align-items:center}.site-mast-right .site-nav-item:last-child{padding-right:0}.site-banner{max-width:80%;margin:0 auto;padding:10vw 0;text-align:center}.site-banner-title{margin:0;padding:0;color:#fff;font-size:4rem;line-height:1.3em}.site-banner-desc{margin:5px 0 0 0;padding:0;font-size:2.4rem;line-height:1.3em;opacity:.7}.site-nav{display:flex;align-items:center;justify-content:space-between;margin:15px 0 0 0}.site-nav-left{margin:0 20px 0 -10px}.site-nav-button{display:inline-block;padding:5px 10px;border:#fff 1px solid;color:#fff;font-size:1.3rem;line-height:1em;border-radius:var(--radius);opacity:.7}.site-nav-button:hover{text-decoration:none}.site-main{padding:4vw 0}.post-feed{display:grid;justify-content:space-between;grid-gap:30px;grid-template-columns:1fr 1fr 1fr}@media (max-width:980px){.post-feed{grid-template-columns:1fr 1fr}}@media (max-width:680px){.post-feed{grid-template-columns:1fr}}.post-card{color:inherit;text-decoration:none}.post-card:hover{text-decoration:none}.post-card-header{display:flex;flex-direction:column}.post-card-tags{margin:0 0 5px 0;font-size:1.4rem;line-height:1.15em;color:var(--color-secondary)}.post-card-title{margin:0 0 10px 0;padding:0}.post-card-excerpt{font-size:1.6rem;line-height:1.55em}.post-card-image{margin:0 0 10px 0;width:auto;height:200px;background:var(--color-secondary) no-repeat center center;background-size:cover;object-fit:cover}.post-card-footer{display:flex;align-items:center;justify-content:space-between;margin:10px 0 0 0;color:var(--color-secondary)}.post-card-footer-left{display:flex;align-items:center}.post-card-footer-right{display:flex;flex-direction:column}.post-card-avatar{width:30px;height:30px;margin:0 7px 0 0;border-radius:100%;display:flex;align-items:center;justify-content:center}.post-card-avatar .author-profile-image{display:block;width:100%;background:var(--color-secondary);border-radius:100%;object-fit:cover}.post-card-avatar .default-avatar{width:26px}.tag-header{max-width:690px;margin:0 0 4vw}.tag-header h1{margin:0 0 1rem 0}.tag-header p{margin:0;color:var(--color-secondary);font-size:2.2rem;line-height:1.3em}@media (max-width:500px){.tag-header{border-bottom:var(--color-bg) 1px solid;padding-bottom:4vw}.tag-header p{font-size:1.7rem}}.author-header{display:flex;justify-content:space-between;margin:0 0 4vw}.author-header h1{margin:0 0 1rem 0}.author-header p{margin:0;color:var(--color-secondary);font-size:2.2rem;line-height:1.3em}.author-header-image{flex:0 0 auto;margin:0 0 0 4vw;height:120px;width:120px;border-radius:100%;overflow:hidden}.author-header-meta{display:flex;margin:1rem 0 0 0}.author-header-item{display:block;padding:2px 10px}.author-header-item:first-child{padding-left:0}@media (max-width:500px){.author-header{border-bottom:var(--color-bg) 1px solid;padding-bottom:4vw}.author-header p{font-size:1.7rem}.author-header-image{height:80px;width:80px}}.pagination{position:relative;display:flex;justify-content:space-between;align-items:center;margin:4vw 0 0}.pagination a{display:inline-block;padding:10px 15px;border:var(--color-border) 1px solid;color:var(--color-secondary);text-decoration:none;font-size:1.4rem;line-height:1em;border-radius:var(--radius)}.pagination-location{position:absolute;left:50%;width:100px;margin-left:-50px;text-align:center;color:var(--color-secondary);font-size:1.3rem}.pagination span{color:var(--color-secondary);opacity:.8}.site-foot{padding:20px 0 40px 0;color:rgba(255,255,255,.7);font-size:1.3rem;background:var(--color-base)}.site-foot-nav{display:flex;align-items:center;justify-content:space-between}.site-foot-nav a{color:rgba(255,255,255,.7)}.site-foot-nav a:hover{text-decoration:none;color:#fff}.site-foot-nav-right a{display:inline-block;padding:2px 5px}.site-foot-nav-right a:last-child{padding-right:0}.kg-bookmark-card{width:100%;margin-top:0}.kg-bookmark-container{display:flex;min-height:148px;color:var(--color-base);font-family:var(--font-sans-serif);text-decoration:none;border-radius:3px;box-shadow:0 2px 5px -1px rgba(0,0,0,.15),0 0 1px rgba(0,0,0,.09)}.kg-bookmark-container:hover{color:var(--color-base);text-decoration:none;box-shadow:0 2px 5px -1px rgba(0,0,0,.15),0 0 1px rgba(0,0,0,.09)}.kg-bookmark-content{flex-grow:1;display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;padding:20px}.kg-bookmark-title{color:color(var(--color-secondary) l(-30%));font-size:1.6rem;line-height:1.5em;font-weight:600;transition:color .2s ease-in-out}.kg-bookmark-container:hover .kg-bookmark-title{color:var(--color-primary)}.kg-bookmark-description{display:-webkit-box;overflow-y:hidden;margin-top:12px;max-height:48px;color:color(var(--color-secondary) l(-10%));font-size:1.5rem;line-height:1.5em;font-weight:400;-webkit-line-clamp:2;-webkit-box-orient:vertical}.kg-bookmark-thumbnail{position:relative;min-width:33%;max-height:100%}.kg-bookmark-thumbnail img{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:0 3px 3px 0;object-fit:cover}.kg-bookmark-metadata{display:flex;flex-wrap:wrap;align-items:center;margin-top:14px;color:color(var(--color-secondary) l(-10%));font-size:1.5rem;font-weight:400}.kg-bookmark-icon{margin-right:8px;width:22px;height:22px}.kg-bookmark-author{line-height:1.5em}.kg-bookmark-author:after{content:"•";margin:0 6px}.kg-bookmark-publisher{overflow:hidden;max-width:240px;line-height:1.5em;text-overflow:ellipsis;white-space:nowrap}.kg-gallery-container{display:flex;flex-direction:column;max-width:1040px;width:100%}.kg-gallery-row{display:flex;flex-direction:row;justify-content:center}.kg-gallery-image img{display:block;margin:0;width:100%;height:100%}.kg-gallery-row:not(:first-of-type){margin:.75em 0 0 0}.kg-gallery-image:not(:first-of-type){margin:0 0 0 .75em}.kg-gallery-card+.kg-gallery-card,.kg-gallery-card+.kg-image-card.kg-width-wide,.kg-image-card.kg-width-wide+.kg-gallery-card,.kg-image-card.kg-width-wide+.kg-image-card.kg-width-wide{margin:-2.25em 0 3em}</style><script>document.documentElement.classList.remove('no-js');</script></head><body><svg xmlns="http://www.w3.org/2000/svg" style="height:0;position:absolute" xmlns:xlink="http://www.w3.org/1999/xlink"><symbol id="facebook" viewBox="0 0 512 512"><path fill="#fff" d="M452 0H60C26.916 0 0 26.916 0 60v392c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V60c0-33.084-26.916-60-60-60zm20 452c0 11.028-8.972 20-20 20H338V309h61.79L410 247h-72v-43c0-16.975 13.025-30 30-30h41v-62h-41c-50.923 0-91.978 41.25-91.978 92.174V247H216v62h60.022v163H60c-11.028 0-20-8.972-20-20V60c0-11.028 8.972-20 20-20h392c11.028 0 20 8.972 20 20v392z"/></symbol><symbol id="rss" viewBox="0 0 643 643"><path fill="#fff" d="M93.299 613.7c-50.798 0-92.117-41.348-92.117-92.117 0-50.827 41.319-92.174 92.117-92.174s92.117 41.376 92.117 92.174c.028 50.77-41.319 92.117-92.117 92.117zm0-155.507c-34.894 0-63.304 28.439-63.304 63.39 0 34.922 28.41 63.304 63.304 63.304 34.893 0 63.303-28.382 63.303-63.304.029-34.95-28.381-63.39-63.303-63.39z"/><path fill="#fff" d="M400.537 614.306h-112.2c-7.952 0-14.407-6.454-14.407-14.407 0-69.585-26.883-134.905-75.664-183.945C149.514 366.998 84.654 340 15.704 340c-7.953 0-14.407-6.454-14.407-14.406V213.336c0-7.953 6.454-14.407 14.407-14.407 220.165 0 399.27 179.883 399.27 400.969-.03 7.982-6.455 14.408-14.437 14.408zm-98.139-28.814h83.473c-7.376-193.743-162.912-349.999-355.79-357.461v83.531c71.285 3.486 137.787 33.021 188.585 84.078 50.828 51.086 80.246 118.048 83.732 189.852z"/><path fill="#fff" d="M598.775 614.363H486.604c-7.952 0-14.406-6.454-14.406-14.407 0-253.04-204.721-458.942-456.378-458.942-7.953 0-14.407-6.454-14.407-14.407v-112.2C1.412 6.455 7.866 0 15.819 0c329.397 0 597.363 269.147 597.363 599.956a14.375 14.375 0 0 1-14.407 14.407zm-97.966-28.813h83.387C576.675 282.085 332.307 36.593 30.226 28.987v83.444c256.124 7.549 463.12 215.64 470.583 473.119z"/></symbol><symbol id="twitter" viewBox="0 0 612.002 612.002"><path fill="#fff" d="M197.553 557.219c-68.018 0-134.159-19.371-191.294-56.047-5.333-3.428-7.591-10.066-5.469-16.051 2.122-5.986 8.189-9.795 14.42-8.896 47.912 5.576 97.919-4.164 139.873-28.16-41.491-12.461-75.228-44.594-88.859-87.199a13.57 13.57 0 0 1 2.802-13.195 13.736 13.736 0 0 1 7.346-4.244c-32.404-24.678-52.864-63.639-52.864-106.436 0-4.816 2.558-10.012 6.72-12.461 4.163-2.449 9.305-3.21 13.495-.925a67.034 67.034 0 0 0 3.646 1.932c-14.719-21.739-22.881-47.749-22.881-74.902 0-23.562 6.23-46.796 18.093-67.147 2.231-3.863 6.23-6.366 10.692-6.72a13.734 13.734 0 0 1 11.59 4.952c55.04 67.501 134.703 110.298 220.624 119.086a135.305 135.305 0 0 1-.571-12.434c0-73.65 59.937-133.588 133.587-133.588 34.199 0 67.311 13.25 92.015 36.648 22.719-5.197 44.484-13.93 64.808-25.983a13.737 13.737 0 0 1 15.399 1.061c4.408 3.537 6.204 9.414 4.489 14.801a132.455 132.455 0 0 1-18.99 37.519 214.647 214.647 0 0 0 16.678-6.584c5.469-2.503 12.025-.979 15.916 3.7 3.891 4.625 4.245 11.291.898 16.324-15.808 23.562-35.07 44.103-57.299 61.162.082 2.938.109 5.904.109 8.842.001 174.453-132.798 354.945-354.973 354.945zm-128.69-53.543c40.458 17.33 84.125 26.336 128.69 26.336 205.17 0 327.766-166.645 327.766-327.765 0-4.979-.136-9.985-.326-14.964a13.59 13.59 0 0 1 5.632-11.59 228.226 228.226 0 0 0 27.507-23.371 255.254 255.254 0 0 1-26.99 4.707c-6.312.898-12.406-2.993-14.501-9.087-2.068-6.067.381-12.76 5.877-16.08a107.521 107.521 0 0 0 28.051-24.296c-13.577 5.197-27.562 9.25-41.845 12.025-4.571.953-9.333-.571-12.543-4.026-20.024-21.331-48.348-33.574-77.677-33.574-58.659 0-106.38 47.721-106.38 106.38 0 8.135.925 16.324 2.774 24.269a13.662 13.662 0 0 1-2.829 11.808c-2.721 3.265-6.829 5.523-11.101 4.843-92.858-4.68-180.33-45.953-243.179-114.189a106.518 106.518 0 0 0-6.094 35.533c0 35.696 17.685 68.753 47.286 88.533a13.578 13.578 0 0 1 5.414 15.454c-1.85 5.768-7.591 9.25-13.358 9.468a133.043 133.043 0 0 1-38.172-6.856c8.407 42.144 40.811 75.555 83.146 84.07 6.203 1.252 10.719 6.557 10.91 12.869.218 6.285-3.917 11.916-9.985 13.604-11.726 3.184-24.051 4.979-36.104 4.734 18.229 32.24 52.456 53.217 90.655 53.979 5.741.109 10.801 3.863 12.624 9.305s0 11.482-4.517 15.02c-38.226 29.953-83.01 47.964-130.731 52.861z"></path></symbol><symbol id="link" viewBox="0 0 16 16"><path d="M5.86 12.7l-.81.8c-.7.7-1.84.7-2.54 0a1.75 1.75 0 0 1 0-2.5l2.98-2.96c.61-.61 1.77-1.52 2.62-.68a1 1 0 1 0 1.4-1.4c-1.44-1.43-3.57-1.17-5.42.67L1.1 9.6a3.72 3.72 0 0 0 0 5.32 3.78 3.78 0 0 0 5.34 0l.8-.8a1 1 0 1 0-1.39-1.42zm9.03-11.5c-1.55-1.53-3.7-1.6-5.14-.19l-1 1a1 1 0 1 0 1.39 1.41l1-1c.75-.74 1.72-.43 2.35.2a1.75 1.75 0 0 1 0 2.5l-3.17 3.15c-1.46 1.45-2.14.77-2.43.48a1 1 0 0 0-1.4 1.4c.67.67 1.43 1 2.23 1 .98 0 2.01-.5 3-1.47l3.17-3.15a3.72 3.72 0 0 0 0-5.32z"></path></symbol><symbol id="nav" viewBox="0 0 16 11"><path d="M0 12h16v-2H0v2zm0-5h16V5H0v2zm0-7v2h16V0H0z"></path></symbol></svg><div class="viewport"><div class="viewport-top"><header class="site-head"><div class="container"><div class="site-mast"><div class="site-mast-right"><a href="https://twitter.com/bonoogiclient" class="site-nav-item" target="_blank" rel="noopener noreferrer"><svg width="16" height="16" class="site-nav-icon site-nav-icon--twitter" role="img" aria-labelledby="twitter-title"><title id="twitter-title">twitter</title><use xlink:href="#twitter" fill="currentColor"></use></svg> </a><a href="https://www.facebook.com/bonoogi" class="site-nav-item" target="_blank" rel="noopener noreferrer"><svg width="16" height="16" class="site-nav-icon site-nav-icon--facebook" role="img" aria-labelledby="facebook-title"><title id="facebook-title">facebook</title><use xlink:href="#facebook" fill="currentColor"></use></svg> </a><a class="site-nav-item" href="https://feedly.com/i/subscription/feed/https://bonoogi.ghost.io/feed.xml" target="_blank" rel="noopener noreferrer"><svg width="16" height="16" class="site-nav-icon site-nav-icon--rss" role="img" aria-labelledby="rss-title"><title id="rss-title">rss</title><use xlink:href="#rss" fill="currentColor"></use></svg></a></div></div><nav class="site-nav"><div class="site-nav-left"><a class="site-nav-item" href="/">Posts </a><a class="site-nav-item" href="/author/bonoogi/">Me? </a><a class="site-nav-item" href="https://github.com/bonoogi">Github</a></div><div class="site-nav-right"></div></nav></div></header><main class="site-main"><div class="container"><article class="content"><section class="post-full-content"><h1 class="content-title">[Swift] Codable로 JSON 좀 더 유연하게 써먹기</h1><section class="content-body load-external-scripts"><p>Swift는 <a href="https://developer.apple.com/documentation/swift/codable">Codable</a> 덕분에 JSON 다루기가 퍽 편한 편이다. 하지만 JSON과 모델이 1:1로 대응하는게 아닌 약간 변칙적인 형태의 JSON을 다루게 되는 경우에는 Codable보다는 <a href="https://github.com/SwiftyJSON/SwiftyJSON">SwiftyJSON</a>과 같은 라이브러리가 좀 더 편하다보니 <em>'아 그냥 Codable 치우고 SwiftyJSON 쓸까?'</em> 싶을때가 종종 있다. 특히 JSON Object가 중첩된 상태이거나, 평평하게 펴진 JSON Object를 중첩된 형태의 모델로 만들거나 해야할 때는 직접 JSON에 대한 Key에 접근해서 값을 대입해주는게 문제 상황에 대처하기 쉽기 때문에 직관적으로 구현하기에는 JSON에 Dictionary 형태로 접근할 수 있는 SwiftyJSON이 훨씬 편하다(아니면 진짜로 JSON을 Dictionary 형태로 만들어버리던가...). 하지만 기왕이면 Codable을 써서 해결하는게 좀 더 편하지 않을까? 그런 측면에서 두가지 경우에 대한 Codable 사용 팁을 준비해봤다.</p><h2 id="flatjsonobjectnestedmodel">Flat JSON Object → Nested Model</h2><p>일단 다음의 두 JSON Object를 보자.</p><pre><code class="language-json">// 주소 정보에 대한 JSON Object
{
    &quot;city&quot;: &quot;솔라특별시&quot;,
    &quot;zipcode&quot;: &quot;00000&quot;
}

// 주소 정보를 포함하는 사람 정보 JSON Object
{
    &quot;name&quot;: &quot;구구리&quot;,
    &quot;city&quot;: &quot;솔라특별시&quot;,
    &quot;zipcode&quot;: &quot;00000&quot;
}
</code></pre><p>위와 같은 경우에 1:1로 대응하는 모델로 구조체를 구현하면 다음과 같은 형태로 만들게 된다.</p><pre><code class="language-swift">struct 주소: Codable {
    let city: String
    let zipcode: String
}

struct 사람: Codable {
    let name: String
    let city: String
    let zipcode: String
}
</code></pre><p>아니 근데, 이거 뭔가 굉장히 불합리하고 맘에 들지 않은 구현이지 않은가? 사람 구조체 안에 <code>city</code>, <code>zipcode</code> 대신 <code>let address: 주소</code> 프로퍼티를 넣어주고 싶지 않은가? 다음처럼 말이다.</p><pre><code class="language-swift">struct 사람: Codable {
    let name: String
    let address: 주소
}
</code></pre><p>다행히 아주 간단하게 해결할 수 있는 방법이 있다. 바로 <a href="https://developer.apple.com/documentation/swift/singlevaluedecodingcontainer">SingleValueDecodingContainer</a>를 이용하는 것이다. SingleValueDecodingContainer는 간단하게 얘기하자면 키가 지정되지 않은 값에 대해 직접 디코딩을 해주는 컨테이너라고 할 수 있다. 바로 이 컨테이너가 JSON Object로부터 <code>address</code>를 디코딩할 수 있도록 해주는 것이다. 실 적용 코드는 다음과 같다.</p><pre><code class="language-swift">struct 사람: Codable {
    let name: String
    let address: 주소
    
    init(from decoder: Decoder) throws {
        let container = try decoder.container(keyedBy: CodingKeys.self)
        self.name = try container.decode(String.self, forKey: .name)
        // Decoder로부터 SingleValueDecodingContainer를 받아와 `주소`를 디코딩한다.
        self.address = try decoder.singleValueContainer().decode(주소.self)
    }
}
</code></pre><p>문제 해결! 이라고 외치고 싶지만, 아직 남은 문제가 있다. 우리가 지금 준수하는 프로토콜은 Codable이기 때문에 Encodable에도 대응해야 하는데, 이대로는 원래의 JSON 형태로 인코딩되지 않고 중첩된 형태의 JSON으로 인코딩된다. 물론 디코딩만 할거면 아무래도 상관없는 문제인데, 기왕 Codable을 쓰는 것이니 Encodable까지 만족시켜보자.</p><pre><code class="language-swift">struct 사람: Codable {
    // ...
    
    enum CodingKeys: CodingKey {
        case name
    }
    
    func encode(to encoder: Encoder) throws {
        var container = encoder.container(CodingKeys.self)
        try container.encode(name, forKey: .name)
        try address.encode(to: encoder)
    }
}
</code></pre><p><code>encode(to encoder:)</code>를 직접 구현할 경우, CodingKeys를 명시적으로 구현해두지 않으면 빌드 오류가 난다. 그러니 일단 우리가 직접 사용하는 키인 <code>name</code>만 선언해두고, <code>address</code> 프로퍼티가 Codable을 준수하고 있으니 <code>encode(to encoder:)</code> 함수를 호출해주면 끝이다. CodingKeys를 따로 구현하는게 귀찮긴 하지만, 또 그렇게까지 어려운 방법은 아니다. 하지만 정 귀찮고 필요없다면 Decodable만 구현하도록 하자. 자, 이제 다음은 그 반대의 상황이다.</p><h2 id="nestedjsonobjectflatmodel">Nested JSON Object → Flat Model</h2><p>이번에는 JSON이 우리가 다음과 같이 중첩된 형태로 온다고 생각해보자. 바로 위의 경우에서였다면 추가 구현 필요없이 그대로 적용할 수 있었을 것이다.</p><pre><code class="language-json">{
    &quot;name&quot;: &quot;구구리&quot;,
    &quot;address&quot;: {
        &quot;city&quot;: &quot;솔라특별시&quot;,
        &quot;zipcode&quot;: &quot;00000&quot;
    }
}
</code></pre><p>아 그런데 알고보니 이를 위해 만들었던 <code>주소</code> 모델이 <code>사람</code> 외의 곳에서는 쓸 곳이 없단다. 외려 이것보다 더 복잡한 형태의 <code>주소</code> 모델을 따로 만들고 저 JSON Object의 <code>address</code>는 <code>사람</code> 모델 안에 넣는게 더 나은 상황이다. 이런 상황을 위해 <a href="https://developer.apple.com/documentation/swift/keyeddecodingcontainer/2893204-nestedcontainer">중첩된 상태를 위한 컨테이너</a>를 가져올 수 있다. 이번애는 Encodable 구현까지 한번에 보자.</p><pre><code class="language-swift">struct 사람: Codable {
    let name: String
    let city: String
    let zipcode: String
    
    enum CodingKeys: CodingKey {
        case name
        case city
        case zipcode
        // 중첩된 JSON Object에 접근하기 위한 키
        case address
    }
    
    init(from decoder: Decoder) throws {
        let container = try decoder.container(keyedBy: CodingKeys.self)
        self.name = try container.decode(String.self, forKey: .name)
        
        // address 키 안의 JSON Object에 대한 컨테이너를 가져온다.
        let addressContainer = try container.nestedContainer(keyedBy: CodingKeys.self, forKey: .address)
        self.city = try addressContainer.decode(String.self, forKey: .city)
        self.zipcode = try addressContainer.decode(String.self, forKey: .zipcode)
    }
    
    func encode(to encoder: Encoder) throws {
        var container = encoder.container(keyedBy: CodingKeys.self)
        try container.encode(name, forKey: .name)
        
        var addressContainer = container.nestedContainer(keyedBy: CodingKeys.self, forKey: .address)
        try addressContainer.encode(city, forKey: .city)
        try addressContainer.encode(zipcode, forKey: .zipcode)
    }
}
</code></pre><p>근데 사실 이것도 굉장히 귀찮은 건 사실이기 때문에 상황에 따라 Decodable만 구현해도 된다면 그렇게 하도록 하자...</p></section></section></article></div></main></div><div class="viewport-bottom"><footer class="site-foot"><div class="site-foot-nav container"><div class="site-foot-nav-left"><a aria-current="page" class="" href="/">Hell yeah, World! </a>&copy; 2020 – Published with <a class="site-foot-nav-item" href="https://ghost.org" target="_blank" rel="noopener noreferrer">Ghost</a></div><div class="site-foot-nav-right"></div></div></footer></div></div></body></html>